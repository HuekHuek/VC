<html><head>
    <title>Video Call</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="css/styles.css" rel="stylesheet" type="text/css">
</head>
<body>

<!-- =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<!-- My Phone Number & Dial Areas -->
<!-- =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<div class="container">
    <div class="row">

        <!-- =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
        <!-- MY PHONE NUMBER -->
        <!-- =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
        <div class="">
            <div id="my-number-section" class="text-center">
                <div id="my-number">816</div>
                <div id="my-number-title" class="hidden-sm hidden-xs">
                    this is <strong>your phone number</strong>
                </div>
                <div id="my-number-permalink">
                    <span class="glyphicon glyphicon-link"></span>
                    call link:
                    <a id="my-number-link" href="https://cyjien.github.io/VC/?call=816">https://cyjien.github.io/VC/?call=816</a>
                </div>
            </div>
            
        </div>

        <!-- =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
        <!-- Video -->
        <!-- =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
        <div class="">
            <!-- DISPLAY -->
            <div class="">
                <div class="">
                    <div id="video-border">
                        <div class="pubnub-relative">
                            <div id="video-self">...834y8uask</div>
                        </div>
                        <div id="video-display"><video autoplay="autoplay" src="blob:https://cyjien.github.io/36dedfe8-2890-49a0-a5a4-b4257f66366a"></video></div>
                    </div>
                    <div id="pubnub-relative">
                        <div id="video-thumbnail"><img src="data:image/jpeg;base64,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"><img src="data:image/jpeg;base64,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"></div>
                    </div>
                </div>
            </div>
            
            <!-- DIAL CONTROLS -->
            <div class="row">
                <div class="col-sm-6 col-xs-7">
                    <div class="form-group"><div class="input-group">
                    <div class="input-group-addon">
                        <span class="glyphicon glyphicon-th"></span>
                    </div>
                    <input id="number" class="form-control" type="number" placeholder="Type Recipient's #">
                    </div></div>
                </div>
                <div class="col-sm-6 col-xs-5 dial-buttons">
                    <button id="dial" class="btn btn-primary">
                        <span class="glyphicon glyphicon-earphone"></span>
                    </button>
                    <button id="snap" class="btn btn-success">
                        <span class="glyphicon glyphicon-camera"></span>
                    </button>
                    <button id="hangup" class="btn btn-danger">
                        <span class="glyphicon glyphicon-ban-circle"></span>
                    </button>                    
                </div>
            </div>
        </div>
    </div>
</div>

<!-- =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- -->
<!-- WebRTC Peer Connections -->
<!-- =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- -->
<!-- IMPORTANT: THIS IS AN UNMINIFIED DEVELOPMENT PUBNUB LIBRARY 
    replace this with the latest versioned, minified CDN lib link before 
    you deploy your app to a production enviornment.
    https://github.com/pubnub/javascript#cdn-links
-->
<script src="https://cdn.pubnub.com/pubnub.js"></script>

<!-- WebRTC SDK -->
<script src="js/webrtc-v2.js"></script>
<script src="js/sound.js"></script>
<script>(function(){

// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
// Generate Random Number if Needed
// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
var urlargs         = urlparams();
var my_number       = PUBNUB.$('my-number');
var my_link         = PUBNUB.$('my-number-link');
var number          = urlargs.number || Math.floor(Math.random()*999+1);

my_number.number    = number;
my_number.innerHTML = ''+my_number.number;
my_link.href        = location.href.split('?')[0] + '?call=' + number;
my_link.innerHTML   = my_link.href;

// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
// Update Location if Not Set
// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
if (!('number' in urlargs)) {
    urlargs.number = my_number.number;
    location.href = urlstring(urlargs);
    return;
}

// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
// Get URL Params
// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
function urlparams() {
    var params = {};
    if (location.href.indexOf('?') < 0) return params;

    PUBNUB.each(
        location.href.split('?')[1].split('&'),
        function(data) { var d = data.split('='); params[d[0]] = d[1]; }
    );

    return params;
}

// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
// Construct URL Param String
// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
function urlstring(params) {
    return location.href.split('?')[0] + '?' + PUBNUB.map(
        params, function( key, val) { return key + '=' + val }
    ).join('&');
}

// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
// Calling & Answering Service
// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
var video_out = PUBNUB.$('video-display');
var img_out   = PUBNUB.$('video-thumbnail');
var img_self  = PUBNUB.$('video-self');

var phone     = window.phone = PHONE({
    number        : my_number.number, // listen on this line
    publish_key   : 'pub-c-561a7378-fa06-4c50-a331-5c0056d0163c',
    subscribe_key : 'sub-c-17b7db8a-3915-11e4-9868-02ee2ddab7fe',
    ssl           : true
});

// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
// Video Session Connected
// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
function connected(session) {
    video_out.innerHTML = '';
    video_out.appendChild(session.video);

    PUBNUB.$('number').value = ''+session.number;
    sounds.play('sound/hi');
    console.log("Hi!");
}

// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
// Video Session Ended
// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
function ended(session) {
    clearInterval(thumbnail.ival);
    thumbnail.ival = 0;
    set_icon('facetime-video');
    img_out.innerHTML = '';
    sounds.play('sound/goodbye');
    console.log("Bye!");
}

// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
// Video Session Ended
// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
function set_icon(icon) {
    video_out.innerHTML = '<span class="glyphicon glyphicon-' +
        icon + '"></span>';
}

// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
// Start Phone Call
// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
function dial(number) {
    // Dial Number
    var session = phone.dial(number);

    // No Dupelicate Dialing Allowed
    if (!session) return;

    // Show Connecting Status
    set_icon('send');
}

// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
// Ready to Send or Receive Calls
// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
phone.ready(function(){
    // Ready To Call
    set_icon('facetime-video');

    // Auto Call
    if ('call' in urlargs) {
        var number = urlargs['call'];
        PUBNUB.$('number').value = number;
        dial(number);
    }

    // Make a Phone Call
    PUBNUB.bind( 'mousedown,touchstart', PUBNUB.$('dial'), function(){
        var number = PUBNUB.$('number').value;
        if (!number) return;
        dial(number);
    } );

    // Hanup Call
    PUBNUB.bind( 'mousedown,touchstart', PUBNUB.$('hangup'), function() {
        phone.hangup();
        set_icon('facetime-video');
    } );

    // Take Picture
    PUBNUB.bind( 'mousedown,touchstart', PUBNUB.$('snap'), function() {
        var photo = phone.snap();
        img_self.innerHTML = ' ';
        img_self.appendChild(photo.image);
        setTimeout( function() { img_self.innerHTML = ' ' }, 750 );
    } );
});

// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
// Received Call Thumbnail
// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
function thumbnail(session) {
    img_out.innerHTML = '';
    img_out.appendChild(session.image);
    img_out.appendChild(phone.snap().image);
}

// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
// Receiver for Calls
// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
phone.receive(function(session){
//     session.message(message);
    session.message(function( session, message ) {
        show_chat( session.number, message.text );
    } );
    session.thumbnail(thumbnail);
    session.connected(connected);
    session.ended(ended);

    if (!thumbnail.ival)
        thumbnail.ival = setInterval( () => thumbnail(session), 100 );
});
        
phone.message(function( session, message ) {
    show_chat( session.number, message.text );
} );

// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
// Chat
// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
var chat_in  = PUBNUB.$('pubnub-chat-input');
var chat_out = PUBNUB.$('pubnub-chat-output');

// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
// Send Chat MSG and update UI for Sending Messages
// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
PUBNUB.bind( 'keydown', chat_in, function(e) {
    if ((e.keyCode || e.charCode) !== 13)     return true;
    if (!chat_in.value.replace( /\s+/g, '' )) return true;

    phone.send({ text : chat_in.value });
    phone.message(function( session, message ) {
        show_chat( session.number, message.text );
    } );
    add_chat( my_number.number + " (Me)", chat_in.value );
    chat_in.value = '';
} )

// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
// Update Local GUI
// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
function add_chat( number, text ) {
    if (!text.replace( /\s+/g, '' )) return true;

    var newchat       = document.createElement('div');
    newchat.innerHTML = PUBNUB.supplant(
        '<strong>{number}: </strong> {message}', {
        message : safetxt(text),
        number  : safetxt(number)
    } );
    chat_out.insertBefore( newchat, chat_out.firstChild );
}

// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
// WebRTC Message Callback
// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
function message( session, message ) {
    add_chat( session.number, message.text );
}

// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
// XSS Prevent
// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
function safetxt(text) {
    return (''+text).replace( /[<>]/g, '' );
}

// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
// Problem Occured During Init
// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
phone.unable(function(details){
    console.log("Alert! - Reload Page.");
    console.log(details);
    set_icon('remove');
});

// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
// Debug Output
// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
phone.debug(function(details){
     // console.log(details);
});

})();</script>


<audio prelaod="auto" autoplay="true" style="display: none;"><source src="sound/hi.ogg"><source src="sound/hi.mp3"></audio></body></html>
